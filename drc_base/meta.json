{
    "args": {
        "__version__": "1.1.2",
        "actor_adam_eps": 0.0001,
        "actor_batch_size": 16,
        "actor_grad_norm_clipping": 1200,
        "actor_learning_rate": 0.0004,
        "actor_ordinal": false,
        "actor_unroll_len": 20,
        "actor_use_rms": false,
        "auto_res": true,
        "base_seed": 1,
        "baseline_cost": 0.5,
        "buffer_traj_len": 50,
        "ckp": false,
        "ckpdir": "/home/mila/i/ivan.anokhin/logs/thinker/drc_check3",
        "cmd": "thinker/train.py --use_wandb true --xpid drc_check3 --drc true --actor_unroll_len 20 --reg_cost 1 --actor_learning_rate 4e-4 --entropy_cost 1e-2 --v_trace_lamb 0.97 --actor_adam_eps 1e-4 --project thinker",
        "critic_enc_f_type": 0,
        "critic_enc_type": 0,
        "critic_zero_init": true,
        "cur_cost": 0.0,
        "cur_cost_anneal": true,
        "cur_done_elapse": 0,
        "cur_done_gate": true,
        "cur_ema": 0.999,
        "cur_enable": false,
        "cur_enc_cost": 1.0,
        "cur_norm_type": 0,
        "cur_pi_cost": 0.0,
        "cur_return_norm_type": -1,
        "cur_reward_adj": -1,
        "cur_reward_bn": 200000,
        "cur_reward_cost": 0.0,
        "cur_reward_lq": 0.05,
        "cur_reward_max": 1000.0,
        "cur_reward_min": 0.0,
        "cur_reward_mq": 0.5,
        "cur_reward_norm": true,
        "cur_reward_pri": true,
        "cur_reward_uq": 0.95,
        "cur_sup_cost": 0.0,
        "cur_v_cost": 0.0,
        "cur_x_cost": 0.0,
        "detect_dan_num": 0,
        "discounting": 0.97,
        "discrete_k": -1,
        "drc": true,
        "dual_net": true,
        "entropy_cost": 0.01,
        "env_n": 64,
        "float16": false,
        "git_revision": "91f8dd61c4d673425b6dbd2d154684fdc99882da",
        "gpu_learn": 0,
        "gpu_learn_actor": 0.25,
        "gpu_self_play": 0.25,
        "grayscale": false,
        "has_action_seq": true,
        "im_cost": 0.0,
        "im_cost_anneal": true,
        "im_enable": false,
        "im_entropy_cost": 0.0001,
        "last_layer_n": 0,
        "legacy": false,
        "max_depth": 5,
        "max_replay_ratio": 6,
        "min_replay_ratio": 5,
        "model_batch_size": 128,
        "model_buffer_n": 200000,
        "model_disable_bn": true,
        "model_done_loss_cost": 1.0,
        "model_downscale_c": 2,
        "model_enc_f_type": 0,
        "model_enc_type": 0,
        "model_grad_norm_clipping": 0,
        "model_has_memory": false,
        "model_img_loss_cost": 10.0,
        "model_img_type": 1,
        "model_learning_rate": 0.0001,
        "model_logits_loss_cost": 0.5,
        "model_mem_unroll_len": 0,
        "model_noise_loss_cost": 0.0,
        "model_ordinal": false,
        "model_reg_loss_cost": 0.0,
        "model_return_n": 5,
        "model_rs_loss_cost": 1.0,
        "model_self_bootstrap": false,
        "model_size_nn": 1,
        "model_sup_loss_cost": 0.0,
        "model_unroll_len": 5,
        "model_vs_loss_cost": 0.25,
        "model_warm_up_n": 200000,
        "model_zero_init": true,
        "name": "Sokoban-v0",
        "noise_alpha": 0.8,
        "noise_d": 10,
        "noise_enable": false,
        "noise_mlp": false,
        "noise_n": 16,
        "one_to_threed_state": false,
        "parallel": true,
        "parallel_actor": true,
        "policy_vis_freq": -1,
        "policy_vis_length": 20,
        "preload": "",
        "preload_actor": "",
        "priority_alpha": 0.6,
        "priority_beta": 0.4,
        "profile": false,
        "project": "thinker",
        "ray_cpu": -1,
        "ray_gpu": -1,
        "ray_mem": -1,
        "real_state_rnn": false,
        "rec_t": 1,
        "reg_cost": 1.0,
        "repeat_action_n": 0,
        "require_prob": true,
        "reset_mode": 0,
        "return_double": false,
        "return_h": false,
        "return_norm_type": -1,
        "return_x": false,
        "reward_clip": -1.0,
        "sample_n": -1,
        "sample_replace": true,
        "sample_temp": 4,
        "savedir": "/home/mila/i/ivan.anokhin/logs/thinker",
        "se_buffer_n": 10,
        "se_lstm_table": false,
        "se_manual_stat": false,
        "se_query_cur": 0,
        "se_query_size": 5,
        "se_td_lambda": 0.9,
        "se_tree_carry": false,
        "see_h": false,
        "see_real_state": true,
        "see_tree_rep": false,
        "see_x": false,
        "self_play_n": 2,
        "sep_im_head": true,
        "stat_mask_type": 0,
        "test_rec_t": -1,
        "total_steps": 50000000,
        "train_actor": true,
        "train_model": false,
        "tran_attn_b": 5,
        "tran_dim": 128,
        "tran_head_n": 8,
        "tran_layer_n": 3,
        "tran_lstm_no_attn": false,
        "tran_mem_n": 40,
        "tran_t": 1,
        "tree_carry": true,
        "tree_rep_rnn": true,
        "use_wandb": true,
        "v_trace_lamb": 0.97,
        "wandb_ckp_freq": 500000,
        "wrapper_type": 1,
        "x_enc_first_pool": true,
        "x_rnn": false,
        "xpid": "drc_check3"
    },
    "date_end": "2024-02-12 05:15:24.793943",
    "date_start": "2024-02-11 12:33:17.909572",
    "env": {
        "ARCHIVE": "/network/archive/i/ivan.anokhin",
        "BASH_ENV": "/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod/init/bash",
        "BASH_FUNC_ml%%": "() {  eval $($LMOD_DIR/ml_cmd \"$@\")\n}",
        "BASH_FUNC_module%%": "() {  eval $($LMOD_CMD bash \"$@\") && eval $(${LMOD_SETTARG_CMD:-:} -s sh)\n}",
        "CONDA_DEFAULT_ENV": "thinker",
        "CONDA_EXE": "/home/mila/i/ivan.anokhin/anaconda3/bin/conda",
        "CONDA_PREFIX": "/home/mila/i/ivan.anokhin/anaconda3/envs/thinker",
        "CONDA_PREFIX_1": "/home/mila/i/ivan.anokhin/anaconda3",
        "CONDA_PROMPT_MODIFIER": "(thinker) ",
        "CONDA_PYTHON_EXE": "/home/mila/i/ivan.anokhin/anaconda3/bin/python",
        "CONDA_SHLVL": "2",
        "CPATH": "/home/mila/i/ivan.anokhin/anaconda3/include",
        "CUDA_VISIBLE_DEVICES": "0",
        "DBUS_SESSION_BUS_ADDRESS": "unix:path=/run/user/1570774224/bus",
        "ENVIRONMENT": "BATCH",
        "FPATH": "/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod/init/ksh_funcs",
        "GPU_DEVICE_ORDINAL": "0",
        "HOME": "/home/mila/i/ivan.anokhin",
        "HOSTNAME": "cn-c014",
        "LANG": "en_US.UTF-8",
        "LC_CTYPE": "en_US.UTF-8",
        "LD_LIBRARY_PATH": "/home/mila/i/ivan.anokhin/anaconda3/envs/thinker/lib/python3.9/site-packages/cv2/../../lib64:/home/mila/i/ivan.anokhin/anaconda3/envs/thinker/lib/python3.9/site-packages/cv2/../../lib64::/home/mila/i/ivan.anokhin/.mujoco/mujoco210/bin:/usr/lib/nvidia",
        "LESSCLOSE": "/usr/bin/lesspipe %s %s",
        "LESSOPEN": "| /usr/bin/lesspipe %s",
        "LMOD_CMD": "/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod/libexec/lmod",
        "LMOD_DIR": "/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod/libexec",
        "LMOD_PACKAGE_PATH": "/cvmfs/config.mila.quebec/etc/lmod/",
        "LMOD_PKG": "/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod",
        "LMOD_ROOT": "/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod",
        "LMOD_SETTARG_FULL_SUPPORT": "no",
        "LMOD_SYSTEM_DEFAULT_MODULES": "Mila",
        "LMOD_VERSION": "8.3.17",
        "LMOD_sys": "Linux",
        "LOADEDMODULES": "Mila",
        "LOGNAME": "ivan.anokhin",
        "LS_COLORS": "rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:",
        "MANPATH": "/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod/share/man:",
        "MODULEPATH": "/cvmfs/config.mila.quebec/modules/Core:/cvmfs/config.mila.quebec/modules/Compiler:/cvmfs/config.mila.quebec/modules/Environments:/cvmfs/config.mila.quebec/modules/Cuda:/cvmfs/config.mila.quebec/modules/Pytorch:/cvmfs/config.mila.quebec/modules/Tensorflow",
        "MODULEPATH_ROOT": "/cvmfs/config.mila.quebec/modules",
        "MODULERCFILE": "/cvmfs/config.mila.quebec/etc/lmod/modulerc.lua",
        "MODULESHOME": "/cvmfs/ai.mila.quebec/apps/x86_64/debian/lmod/lmod",
        "MOTD_SHOWN": "pam",
        "OLDPWD": "/home/mila/i/ivan.anokhin",
        "OMP_NUM_THREADS": "1",
        "PATH": "/home/mila/i/ivan.anokhin/anaconda3/envs/thinker/bin:/home/mila/i/ivan.anokhin/anaconda3/condabin:/cvmfs/config.mila.quebec/bin/local:/cvmfs/config.mila.quebec/bin:/opt/slurm/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/opt/slurm/bin",
        "PWD": "/home/mila/i/ivan.anokhin/thinker_private",
        "PYGAME_HIDE_SUPPORT_PROMPT": "hide",
        "PYTHONBREAKPOINT": "ray.util.rpdb.set_trace",
        "QT_QPA_FONTDIR": "/home/mila/i/ivan.anokhin/anaconda3/envs/thinker/lib/python3.9/site-packages/cv2/qt/fonts",
        "QT_QPA_PLATFORM_PLUGIN_PATH": "/home/mila/i/ivan.anokhin/anaconda3/envs/thinker/lib/python3.9/site-packages/cv2/qt/plugins",
        "RAY_CLIENT_MODE": "0",
        "RAY_JOB_ID": "01000000",
        "RAY_RAYLET_PID": "2406214",
        "RAY_USAGE_STATS_ENABLED": "0",
        "ROCR_VISIBLE_DEVICES": "0",
        "SACCT_FORMAT": "User,JobID,Jobname,partition,state,time,start,end,elapsed,nnodes,ncpus,reqmem,alloctres,nodelist,workdir",
        "SCRATCH": "/network/scratch/i/ivan.anokhin",
        "SHELL": "/bin/bash",
        "SHLVL": "2",
        "SINFO_FORMAT": "%18N %.6D %.11T %.4c %.8z %.6m %.8d %.6w %.22f %80E",
        "SLURMD_NODENAME": "cn-c014",
        "SLURM_CLUSTER_NAME": "mila",
        "SLURM_CONF": "/etc/slurm/slurm.conf",
        "SLURM_CPUS_ON_NODE": "16",
        "SLURM_CPUS_PER_TASK": "16",
        "SLURM_GPUS_ON_NODE": "1",
        "SLURM_GPUS_PER_NODE": "1",
        "SLURM_GTIDS": "0",
        "SLURM_JOBID": "4148161",
        "SLURM_JOB_ACCOUNT": "mila",
        "SLURM_JOB_CPUS_PER_NODE": "16",
        "SLURM_JOB_END_TIME": "1707845565",
        "SLURM_JOB_GID": "1570774224",
        "SLURM_JOB_GPUS": "5",
        "SLURM_JOB_ID": "4148161",
        "SLURM_JOB_NAME": "thinker",
        "SLURM_JOB_NODELIST": "cn-c014",
        "SLURM_JOB_NUM_NODES": "1",
        "SLURM_JOB_PARTITION": "long",
        "SLURM_JOB_QOS": "normal",
        "SLURM_JOB_START_TIME": "1707672765",
        "SLURM_JOB_UID": "1570774224",
        "SLURM_JOB_USER": "ivan.anokhin",
        "SLURM_LOCALID": "0",
        "SLURM_MEM_PER_NODE": "32768",
        "SLURM_NNODES": "1",
        "SLURM_NODEID": "0",
        "SLURM_NODELIST": "cn-c014",
        "SLURM_NODE_ALIASES": "(null)",
        "SLURM_PRIO_PROCESS": "0",
        "SLURM_PROCID": "0",
        "SLURM_SCRIPT_CONTEXT": "prolog_task",
        "SLURM_SUBMIT_DIR": "/home/mila/i/ivan.anokhin/thinker_private",
        "SLURM_SUBMIT_HOST": "login-1",
        "SLURM_TASKS_PER_NODE": "1",
        "SLURM_TASK_PID": "2405788",
        "SLURM_TMPDIR": "/Tmp/slurm.4148161.0",
        "SLURM_TOPOLOGY_ADDR": "cn-c014",
        "SLURM_TOPOLOGY_ADDR_PATTERN": "node",
        "SLURM_WORKING_CLUSTER": "mila:slurmctl01:6817:9984:109",
        "SPT_NOENV": "1",
        "SQUEUE_FORMAT": "%.8i %.8u %.12P %.14j %.3t %16S %.10M %.5D %.4C %.10b %.7m %N (%r) %k",
        "SSH_CLIENT": "45.45.28.249 54200 22",
        "SSH_CONNECTION": "45.45.28.249 54200 172.16.2.151 22",
        "SSH_TTY": "/dev/pts/20",
        "TERM": "xterm-256color",
        "TMPDIR": "/tmp",
        "USER": "ivan.anokhin",
        "WANDB_API_KEY": "df61f407e5d9259d358ba2a7ef24aa3038bec740",
        "WANDB_USERNAME": "avecplezir",
        "XDG_RUNTIME_DIR": "/run/user/1570774224",
        "XDG_SESSION_CLASS": "user",
        "XDG_SESSION_ID": "1188",
        "XDG_SESSION_TYPE": "tty",
        "ZE_AFFINITY_MASK": "0",
        "_": "/home/mila/i/ivan.anokhin/anaconda3/envs/thinker/bin/python",
        "_CE_CONDA": "",
        "_CE_M": "",
        "_LMFILES_": "/cvmfs/config.mila.quebec/modules/Core/Mila.lua",
        "_ModuleTable001_": "X01vZHVsZVRhYmxlXz17WyJNVHZlcnNpb24iXT0zLFsiY19yZWJ1aWxkVGltZSJdPWZhbHNlLFsiY19zaG9ydFRpbWUiXT1mYWxzZSxkZXB0aFQ9e30sZmFtaWx5PXt9LG1UPXtNaWxhPXtbImZuIl09Ii9jdm1mcy9jb25maWcubWlsYS5xdWViZWMvbW9kdWxlcy9Db3JlL01pbGEubHVhIixbImZ1bGxOYW1lIl09Ik1pbGEiLFsibG9hZE9yZGVyIl09MSxwcm9wVD17bG1vZD17WyJzdGlja3kiXT0xLH0sfSxbInN0YWNrRGVwdGgiXT0wLFsic3RhdHVzIl09ImFjdGl2ZSIsWyJ1c2VyTmFtZSJdPSJNaWxhIix9LH0sbXBhdGhBPXsiL2N2bWZzL2NvbmZpZy5taWxhLnF1ZWJlYy9tb2R1bGVzL0NvcmUiLCIvY3ZtZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvQ29tcGlsZXIi",
        "_ModuleTable002_": "LCIvY3ZtZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvRW52aXJvbm1lbnRzIiwiL2N2bWZzL2NvbmZpZy5taWxhLnF1ZWJlYy9tb2R1bGVzL0N1ZGEiLCIvY3ZtZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvUHl0b3JjaCIsIi9jdm1mcy9jb25maWcubWlsYS5xdWViZWMvbW9kdWxlcy9UZW5zb3JmbG93Iix9LFsic3lzdGVtQmFzZU1QQVRIIl09Ii9jdm1mcy9jb25maWcubWlsYS5xdWViZWMvbW9kdWxlcy9Db3JlOi9jdm1mcy9jb25maWcubWlsYS5xdWViZWMvbW9kdWxlcy9Db21waWxlcjovY3ZtZnMvY29uZmlnLm1pbGEucXVlYmVjL21vZHVsZXMvRW52aXJvbm1lbnRzOi9jdm1mcy9jb25maWcubWlsYS5xdWViZWMvbW9kdWxlcy9DdWRhOi9jdm1mcy9jb25m",
        "_ModuleTable003_": "aWcubWlsYS5xdWViZWMvbW9kdWxlcy9QeXRvcmNoOi9jdm1mcy9jb25maWcubWlsYS5xdWViZWMvbW9kdWxlcy9UZW5zb3JmbG93Iix9",
        "_ModuleTable_Sz_": "3",
        "__Init_Default_Modules": "1",
        "__LMOD_REF_COUNT_LOADEDMODULES": "Mila:1",
        "__LMOD_REF_COUNT_MODULEPATH": "/cvmfs/config.mila.quebec/modules/Core:1;/cvmfs/config.mila.quebec/modules/Compiler:1;/cvmfs/config.mila.quebec/modules/Environments:1;/cvmfs/config.mila.quebec/modules/Cuda:1;/cvmfs/config.mila.quebec/modules/Pytorch:1;/cvmfs/config.mila.quebec/modules/Tensorflow:1",
        "__LMOD_REF_COUNT_PATH": "/cvmfs/config.mila.quebec/bin/local:1;/cvmfs/config.mila.quebec/bin:1;/opt/slurm/bin:2;/usr/local/sbin:1;/usr/local/bin:1;/usr/sbin:1;/usr/bin:1;/sbin:1;/bin:1;/usr/games:1;/usr/local/games:1",
        "__LMOD_REF_COUNT__LMFILES_": "/cvmfs/config.mila.quebec/modules/Core/Mila.lua:1",
        "__LMOD_SET_FPATH": "1"
    },
    "git": {
        "branch": "drcB",
        "commit": "91f8dd61c4d673425b6dbd2d154684fdc99882da",
        "path": "/home/mila/i/ivan.anokhin/thinker_private/.git"
    },
    "slurm": {
        "cluster_name": "mila",
        "conf": "/etc/slurm/slurm.conf",
        "cpus_on_node": "16",
        "cpus_per_task": "16",
        "gpus_on_node": "1",
        "gpus_per_node": "1",
        "gtids": "0",
        "job_account": "mila",
        "job_cpus_per_node": "16",
        "job_end_time": "1707845565",
        "job_gid": "1570774224",
        "job_gpus": "5",
        "job_id": "4148161",
        "job_name": "thinker",
        "job_nodelist": "cn-c014",
        "job_num_nodes": "1",
        "job_partition": "long",
        "job_qos": "normal",
        "job_start_time": "1707672765",
        "job_uid": "1570774224",
        "job_user": "ivan.anokhin",
        "jobid": "4148161",
        "localid": "0",
        "mem_per_node": "32768",
        "nnodes": "1",
        "node_aliases": "(null)",
        "nodeid": "0",
        "nodelist": "cn-c014",
        "nodename": "cn-c014",
        "prio_process": "0",
        "procid": "0",
        "script_context": "prolog_task",
        "submit_dir": "/home/mila/i/ivan.anokhin/thinker_private",
        "submit_host": "login-1",
        "task_pid": "2405788",
        "tasks_per_node": "1",
        "tmpdir": "/Tmp/slurm.4148161.0",
        "topology_addr": "cn-c014",
        "topology_addr_pattern": "node",
        "working_cluster": "mila:slurmctl01:6817:9984:109"
    },
    "successful": true,
    "xpid": "drc_check3"
}